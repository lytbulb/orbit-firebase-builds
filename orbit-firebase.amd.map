{"version":3,"sources":["orbit-firebase/cache-source.js","orbit-firebase/firebase-client.js","orbit-firebase/firebase-connector.js","orbit-firebase/firebase-listener.js","orbit-firebase/firebase-requester.js","orbit-firebase/firebase-serializer.js","orbit-firebase/firebase-source.js","orbit-firebase/firebase-transformer.js","orbit-firebase/lib/array-utils.js","orbit-firebase/lib/cache-utils.js","orbit-firebase/lib/object-utils.js","orbit-firebase/lib/operation-utils.js","orbit-firebase/lib/promise-utils.js","orbit-firebase/lib/schema-utils.js","orbit-firebase/mixins/invocations-tracker.js","orbit-firebase/operation-decomposer.js","orbit-firebase/operation-filter.js","orbit-firebase/operation-matcher.js","orbit-firebase/operation-sequencer.js","orbit-firebase/related-inverse-links.js","orbit-firebase/subscriptions/attribute-subscription.js","orbit-firebase/subscriptions/has-many-subscription.js","orbit-firebase/subscriptions/has-one-subscription.js","orbit-firebase/subscriptions/options.js","orbit-firebase/subscriptions/record-subscription.js","orbit-firebase/subscriptions/subscription.js","orbit-firebase/transformations.js","orbit-firebase/transformers/add-record.js","orbit-firebase/transformers/add-to-has-many.js","orbit-firebase/transformers/add-to-has-one.js","orbit-firebase/transformers/remove-from-has-many.js","orbit-firebase/transformers/remove-has-one.js","orbit-firebase/transformers/remove-record.js","orbit-firebase/transformers/replace-attribute.js","orbit-firebase/transformers/replace-has-many.js","orbit-firebase/transformers/update-meta.js"],"sourcesContent":["define('orbit-firebase/cache-source', ['exports', 'orbit/transformable', 'orbit/lib/objects'], function (exports, Transformable, objects) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(cache){\n\t\t\tTransformable['default'].extend(this);\n\t\t\tthis._cache = cache;\n\t\t\tobjects.expose(this, this._cache, ['retrieve']);\n\t\t},\n\n\t\t_transform: function(operations){\n\t\t\tvar _this = this;\n\t\t\toperations = objects.isArray(operations) ? operations : [operations];\n\n\t\t\toperations.forEach(function(operation){\n\t\t\t\t_this._cache.transform(operation);\n\t\t\t});\n\t\t}\n\t});\n\n});","define('orbit-firebase/firebase-client', ['exports', 'orbit/lib/objects', 'orbit/main', 'orbit-firebase/lib/array-utils'], function (exports, objects, Orbit, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseRef){\n\t\t\tthis.firebaseRef = firebaseRef;\n\t\t},\n\n\t\tauthenticateAdmin: function(secret){\n\t\t\treturn this._authenticate(secret);\n\t\t},\n\n\t\tauthenticateUser: function(secret, userDetails){\n\t\t\tvar tokenGenerator = new FirebaseTokenGenerator(secret);\n\t    var userToken = tokenGenerator.createToken(userDetails);\n\t    return this._authenticate(userToken);\n\t\t},\n\n\t\t_authenticate: function(token){\n\t\t\tvar _this = this;\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t_this.firebaseRef.authWithCustomToken(token, function(error){\n\t\t\t\t\tif(error){\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tset: function(path, value){\n\t\t\tpath = this._normalizePath(path);\n\n\t\t\tvar _this = this;\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\tvalue = value === undefined ? null : value; // undefined causes error in firebase client\n\t\t\t\t_this.firebaseRef.child(path).set(value, function(error){\n\t\t\t\t\terror ? reject(error) : resolve(value); // jshint ignore:line\n\t\t\t\t});\n\t\t\t});\n\n\t\t},\n\n\t\tpush: function(path, value){\n\t\t\tvar _this = this;\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t_this.firebaseRef.child(path).push(value, function(error){\n\t\t\t\t\tif(error) {\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tremove: function(path){\n\t\t\tvar _this = this;\n\t\t\tpath = this._normalizePath(path);\n\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t_this.firebaseRef.child(path).remove(function(error){\n\t\t\t\t\terror ? reject(error) : resolve(); // jshint ignore:line\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tvalueAt: function(path){\n\t\t\tvar _this = this;\n\t\t\tpath = this._normalizePath(path);\n\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t_this.firebaseRef.child(path).once('value', function(snapshot){\n\n\t\t\t\t\tresolve(snapshot.val());\n\n\t\t\t\t}, function(error){\n\t\t\t\t\treject(error);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tremoveFromArray: function(arrayPath, value){\n\t\t\tvar _this = this;\n\n\t\t\treturn this.valueAt(arrayPath).then(function(array){\n\t\t\t\tif(!array) return;\n\n\t\t\t\tvar index = array.indexOf(value);\n\t\t\t\tif(index === -1) return Orbit['default'].resolve();\n\n\t\t\t\tarray.splice(index, 1);\n\t\t\t\treturn _this.set(arrayPath, array);\n\t\t\t});\n\t\t},\n\n\t\tremoveFromArrayAt: function(arrayPath, index){\n\t\t\tvar _this = this;\n\t\t\tarrayPath = this._normalizePath(arrayPath);\n\n\t\t\treturn this.valueAt(arrayPath).then(function(array){\n\t\t\t\tif(!array) return;\n\n\t\t\t\tarray = array_utils.removeAt(array, index);\n\t\t\t\treturn _this.set(arrayPath, array);\n\t\t\t});\n\t\t},\n\n\t\tappendToArray: function(arrayPath, value){\n\t\t\tvar _this = this;\n\t\t\tarrayPath = this._normalizePath(arrayPath);\n\n\t\t\treturn _this.valueAt(arrayPath).then(function(array){\n\t\t\t\tarray = array || [];\n\t\t\t\tif(array.indexOf(value) === -1){\n\t\t\t\t\tarray.push(value);\n\t\t\t\t}\n\t\t\t\treturn _this.set(arrayPath, array);\n\n\t\t\t});\n\t\t},\n\n\t    _normalizePath: function(path) {\n\t    \treturn (typeof path === 'string') ? path : path.join('/');\n\t    },\n\t});\n\n});","define('orbit-firebase/firebase-connector', ['exports', 'orbit/transform-connector'], function (exports, TransformConnector) {\n\n  'use strict';\n\n  exports['default'] = TransformConnector['default'].extend({\n    filterFunction: function(operation){\n      var path = operation.path;\n      var recordPath = [path[0], path[1]];\n      var record = this.target.retrieve(recordPath);\n\n      if(!record && path.length > 2) return false;\n      if(record && path.length === 2) return false;\n      return true;\n    }\n  });\n\n});","define('orbit-firebase/firebase-listener', ['exports', 'orbit/lib/objects', 'orbit/lib/eq', 'orbit/lib/assert', 'orbit/evented', 'orbit-firebase/lib/schema-utils', 'orbit/operation', 'orbit-firebase/firebase-client', 'orbit/main', 'orbit-firebase/lib/array-utils', 'orbit-firebase/subscriptions/record-subscription', 'orbit-firebase/subscriptions/attribute-subscription', 'orbit-firebase/subscriptions/has-many-subscription', 'orbit-firebase/subscriptions/has-one-subscription', 'orbit-firebase/subscriptions/options', 'orbit-firebase/lib/object-utils', 'orbit-firebase/mixins/invocations-tracker'], function (exports, objects, eq, assert, Evented, SchemaUtils, Operation, FirebaseClient, Orbit, array_utils, RecordSubscription, AttributeSubscription, HasManySubscription, HasOneSubscription, subscriptions__options, object_utils, InvocationsTracker) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseRef, schema, serializer){\n\t\t\tEvented['default'].extend(this);\n\t\t\tInvocationsTracker['default'].extend(this);\n\t\t\twindow.firebaseListener = this;\n\n\t\t\tthis._firebaseRef = firebaseRef;\n\t\t\tthis._firebaseClient = new FirebaseClient['default'](this._firebaseRef);\n\t\t\tthis._schema = schema;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t\tthis._serializer = serializer;\n\n\t\t\tthis._listeners = {};\n\t\t\tthis._listenerInitializers = {};\n\t\t\tthis._subscriptions = {};\n\n\t\t\tthis._addSubscription = this._trackInvocations(this._addSubscription);\n\t\t},\n\n\t\tsubscribeToType: function(type, _, subscriptionOptions){\n\t\t\tvar _this = this;\n\t\t\tvar typeRef = this._firebaseRef.child('type');\n\t\t\tsubscriptionOptions = subscriptions__options.buildOptions(subscriptionOptions);\n\n\t\t\tthis._enableListener(type, 'child_added', function(snapshot){\n\t\t\t\tvar record = snapshot.val();\n\t\t\t\t_this.subscribeToRecord(type, record.id, subscriptionOptions);\n\t\t\t});\n\t\t},\n\n\t\tsubscribeToRecords: function(type, ids, options){\n\t\t\tvar _this = this;\n\t\t\tvar promises = array_utils.map(ids, function(id){\n\t\t\t\treturn _this.subscribeToRecord(type, id, options);\n\t\t\t});\n\n\t\t\treturn this._settleAllPermitted(promises);\n\t\t},\n\n\t\t_settleAllPermitted: function(promises){\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\treturn Orbit['default'].allSettled(promises).then(function(settled){\n\t\t\t\t\tvar values = [];\n\n\t\t\t\t\tsettled.forEach(function(promiseResult){\n\t\t\t\t\t\tif(promiseResult.state === 'rejected'){\n\t\t\t\t\t\t\tif(promiseResult.reason.code === 'PERMISSION_DENIED'){\n\t\t\t\t\t\t\t\t// filter out values that have access denied\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthrow new Error(promiseResult.reason);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(promiseResult.state === 'fulfilled'){\n\t\t\t\t\t\t\tvalues.push(promiseResult.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tresolve(values);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\tsubscribeToRecord: function(type, id, subscriptionOptions){\n\t\t\tvar path = [type, id].join(\"/\");\n\t\t\tsubscriptionOptions = subscriptions__options.buildOptions(subscriptionOptions);\n\n\t\t\treturn this._addSubscription(path, RecordSubscription['default'], subscriptionOptions);\n\t\t},\n\n\t\tsubscriptions: function(){\n\t\t\treturn Object.keys(this._subscriptions);\n\t\t},\n\n\t\tactiveSubscriptions: function(){\n\t\t\tvar _this = this;\n\n\t\t\treturn this.subscriptions().filter(function(subscription){\n\t\t\t\treturn _this._subscriptions[subscription].status === 'active';\n\t\t\t});\n\t\t},\n\n\t\thasActiveSubscription: function(subscriptionPath){\n\t\t\tvar subscription = this._subscriptions[subscriptionPath];\n\t\t\treturn subscription && subscription.status === 'active';\n\t\t},\n\n\t\tunsubscribeAll: function(){\n\t\t\tvar _this = this;\n\n\t\t\treturn this.then(function(){\n\t\t\t\tObject.keys(_this._listeners).forEach(function(listenerKey){\n\t\t\t\t\tvar path = listenerKey.split(\":\")[0];\n\t\t\t\t\tvar eventType = listenerKey.split(\":\")[1];\n\t\t\t\t\tvar callback = _this._listeners[listenerKey];\n\n\t\t\t\t\t_this._disableListener(path, eventType, callback);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t_subscribeToAttribute: function(type, id, attribute){\n\t\t\tvar path = [type, id, attribute].join(\"/\");\n\t\t\treturn this._addSubscription(path, AttributeSubscription['default']);\n\t\t},\n\n\t\tsubscribeToLink: function(type, id, link, options){\n\t\t\tvar _this = this;\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(type, link).type;\n\n\t\t\tif(linkType === 'hasOne'){\n\t\t\t\treturn this._subscribeToHasOne(type, id, link, options);\n\n\t\t\t} else if (linkType === 'hasMany'){\n\t\t\t\treturn this._subscribeToHasMany(type, id, link, options);\n\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unsupported link type: \" + linkType);\n\t\t\t}\n\n\t\t},\n\n\t\t_subscribeToHasOne: function(type, id, link, options){\n\t\t\tvar _this = this;\n\t\t\tvar path = [type, id, link].join(\"/\");\n\n\t\t\treturn this._addSubscription(path, HasOneSubscription['default'], options);\n\t\t},\n\n\t\tfindSubscription: function(path){\n\t\t\treturn this._subscriptions[path];\n\t\t},\n\n\t\t_subscribeToHasMany: function(type, id, link, options){\n\t\t\tvar _this = this;\n\t\t\tvar path = [type, id, link].join(\"/\");\n\n\t\t\treturn this._addSubscription(path, HasManySubscription['default'], options);\n\t\t},\n\n\t\t_addSubscription: function(path, SubscriptionClass, subscriptionOptions){\n\t\t\tsubscriptionOptions = subscriptions__options.buildOptions(subscriptionOptions);\n\t\t\tvar _this = this;\n\t\t\tvar subscription = this.findSubscription(path);\n\n\t\t\tif(!subscription) {\n\t\t\t\tsubscription = this._createSubscription(SubscriptionClass, path);\n\t\t\t\tthis._subscriptions[path] = subscription;\n\t\t\t}\n\n\t\t\treturn subscription.enqueue(function(){\n\t\t\t\tvar promise;\n\n\t\t\t\tif(subscription.status === 'permission_denied') promise = Orbit['default'].resolve(subscription);\n\t\t\t\telse if(subscription.status === 'new') promise = _this._activateSubscription(subscription, subscriptionOptions);\n\t\t\t\telse promise = _this._updateSubscription(subscription, subscriptionOptions);\n\n\t\t\t\treturn promise.then(function(){\n\t\t\t\t\treturn subscription;\n\t\t\t\t});\n\n\t\t\t}).catch(function(error){\n\t\t\t\tsubscription.status = error.code === \"PERMISSION_DENIED\" ? \"permission_denied\" : \"error\";\n\n\t\t\t\tif(subscription.status !== \"permission_denied\") throw error;\n\n\t\t\t\treturn subscription;\n\n\t\t\t});\n\t\t},\n\n\t\t_createSubscription: function(SubscriptionClass, path, options){\n\t\t\tvar subscription = new SubscriptionClass(path, this);\n\t\t\tsubscription.status = \"new\";\n\t\t\treturn subscription;\n\t\t},\n\n\t\t_activateSubscription: function(subscription, options){\n\t\t\tsubscription.options = options;\n\t\t\tsubscription.status = \"activating\";\n\n\t\t\treturn subscription.activate().then(\n\t\t\t\tfunction(){\n\t\t\t\t\tsubscription.status = \"active\";\n\t\t\t\t\treturn subscription;\n\n\t\t\t\t});\n\t\t},\n\n\t\t_updateSubscription: function(subscription, options){\n\t\t\tvar mergedOptions = this._mergeOptions(subscription.options, options);\n\t\t\tif(!eq.eq(mergedOptions, subscription.options)){\n\t\t\t\tsubscription.options = options;\n\t\t\t\treturn subscription.update();\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn Orbit['default'].resolve();\n\t\t\t}\n\t\t},\n\n\t\t_mergeOptions: function(current, requested){\n\t\t\treturn object_utils.deepMerge(current, requested);\n\t\t},\n\n\t\t_emitDidTransform: function(operation){\n\t\t\t// console.log(\"fb.emitted\", [operation.id, operation.op, operation.path.join(\"/\"), JSON.stringify(operation.value)].join(\"::\"));\n\t\t\tthis.emit(\"didTransform\", operation);\n\t\t},\n\n\t\t_loadRecord: function(type, recordId){\n\t\t\tvar _this = this;\n\t\t\tvar path = [type, recordId].join(\"/\");\n\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t_this._firebaseRef.child(path).once(\"value\",\n\t\t\t\t\tfunction(snapshot){\n\t\t\t\t\t\tvar deserializedRecord = _this._serializer.deserialize(type, recordId, snapshot.val());\n\n\t\t\t\t\t\t_this._emitDidTransform(new Operation['default']({ op: 'add', path: path, value: deserializedRecord }) );\n\t\t\t\t\t\tresolve(deserializedRecord);\n\t\t\t\t\t},\n\t\t\t\t\tfunction(error){\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\t\t},\n\n\t\t_enableListener: function(path, eventType, callback){\n\t\t\tvar _this = this;\n\t\t\tpath = (typeof path === 'string') ? path : path.join('/');\n\t\t\tvar key = this._buildListenerKey(path, eventType);\n\n\t\t\tif(!this._listenerInitializers[key]){\n\t\t\t\tthis._listenerInitializers[key] = new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\t\tvar wrappedCallback = function(){\n\t\t\t\t\t\tresolve(callback.apply(_this, arguments));\n\t\t\t\t\t};\n\n\t\t\t\t\t_this._listeners[key] = wrappedCallback;\n\t\t\t\t\t_this._firebaseRef.child(path).on(eventType, wrappedCallback, function(error){\n\t\t\t\t\t\tdelete _this._listeners[key];\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn this._listenerInitializers[key];\n\t\t},\n\n\t\t_disableListener: function(path, eventType, callback){\n\t\t\tthis._firebaseRef.child(path).off(eventType, callback);\n\t\t},\n\n\t\t_listenerExists: function(key){\n\t\t\treturn this._listeners[key];\n\t\t},\n\n\t\t_buildListenerKey: function(path, eventType){\n\t\t\treturn [path, eventType].join(\":\");\n\t\t},\n\n\t\t_normalizePath: function(path) {\n\t\t\treturn (typeof path === 'string') ? path.split(\"/\") : path;\n\t\t}\n\t});\n\n});","define('orbit-firebase/firebase-requester', ['exports', 'orbit/lib/objects', 'orbit-firebase/lib/object-utils', 'orbit-firebase/lib/array-utils', 'orbit-firebase/lib/schema-utils', 'orbit/main', 'orbit/lib/assert', 'orbit-common/lib/exceptions'], function (exports, objects, object_utils, array_utils, SchemaUtils, Orbit, assert, exceptions) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema, serializer){\n\t\t\tassert.assert('FirebaseSource requires Orbit.map be defined', Orbit['default'].map);\n\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schema = schema;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t\tthis._serializer = serializer;\n\t\t},\n\n\t\tfind: function(type, id){\n\t\t\tif(id){\n\t\t\t\tif(objects.isArray(id)) return this._findMany(type, id);\n\t\t\t\treturn this._findOne(type, id);\n\t\t\t}\n\t\t\telse {\n\t\t\t\treturn this._findAll(type);\n\t\t\t}\n\t\t},\n\n\t\tfindLink: function(type, id, link){\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(type, link).type;\n\t\t\treturn this._firebaseClient.valueAt([type, id, link]).then(function(linkValue){\n\t\t\t\tif(linkType === 'hasMany') {\n\t\t\t\t\treturn linkValue ? Object.keys(linkValue) : [];\n\t\t\t\t}\n\t\t\t\telse if(linkType === 'hasOne') {\n\t\t\t\t\treturn linkValue;\n\t\t\t\t}\n\t\t\t\tthrow new Error(\"Links of type \" + linkType + \" not handled\");\n\t\t\t});\n\t\t},\n\n\t\tfindLinked: function(type, id, link){\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(type, link).type;\n\t\t\tif(linkType === 'hasMany') {\n\t\t\t\treturn this._findLinkedHasMany(type, id, link);\n\t\t\t}\n\t\t\telse if(linkType === 'hasOne') {\n\t\t\t\treturn this._findLinkedHasOne(type, id, link);\n\t\t\t}\n\t\t\tthrow new Error(\"Links of type \" + linkType + \" not handled\");\n\t\t},\n\n\t\t_findOne: function(type, id){\n\t\t\tvar _this = this;\n\n\t\t\treturn _this._firebaseClient.valueAt([type, id]).then(function(record){\n\t\t\t\t// todo - is this the correct behaviour for not found?\n\t\t\t\tif(!record) throw new exceptions.RecordNotFoundException(type + \":\" + id);\n\t\t\t\treturn _this._serializer.deserialize(type, id, record);\n\t\t\t});\n\t\t},\n\n\t\t_findMany: function(type, ids){\n\t\t\tvar _this = this;\n\t\t\tvar promises = array_utils.map(ids, function(id){\n\t\t\t\treturn _this._findOne(type, id);\n\t\t\t});\n\n\t\t\treturn Orbit['default'].all(promises);\n\t\t},\n\n\t\t_findAll: function(type){\n\t\t\tvar _this = this;\n\t\t\treturn _this._firebaseClient.valueAt(type).then(function(recordsHash){\n\t\t\t\tvar records = object_utils.objectValues(recordsHash);\n\t\t\t\treturn _this._serializer.deserializeRecords(type, records);\n\t\t\t});\n\t\t},\n\n\t\t_findLinkedHasMany: function(type, id, link){\n\t\t\tvar _this = this;\n\t\t\tvar linkDef = this._schemaUtils.lookupLinkDef(type, link);\n\t\t\tvar model = linkDef.model;\n\n\t\t\treturn this.findLink(type, id, link).then(function(ids){\n\t\t\t\tvar promised = [];\n\t\t\t\tfor(var i = 0; i < ids.length; i++){\n\t\t\t\t\tpromised[i] = _this._firebaseClient.valueAt([model, ids[i]]);\n\t\t\t\t}\n\n\t\t\t\treturn _this._settleAllPermitted(promised).then(function(serialized){\n\t\t\t\t\treturn array_utils.map(serialized, function(record){\n\t\t\t\t\t\treturn _this._serializer.deserialize(model, record.id, record);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t_settleAllPermitted: function(promises){\n\t\t\treturn new Orbit['default'].Promise(function(resolve, reject){\n\t\t\t\tOrbit['default'].allSettled(promises).then(function(settled){\n\t\t\t\t\tvar values = [];\n\n\t\t\t\t\tsettled.forEach(function(promiseResult){\n\t\t\t\t\t\tif(promiseResult.state === 'rejected'){\n\t\t\t\t\t\t\tif(promiseResult.reason.code === 'PERMISSION_DENIED'){\n\t\t\t\t\t\t\t\t// filter out values that have access denied\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthrow new Error(promiseResult.reason);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if(promiseResult.state === 'fulfilled'){\n\t\t\t\t\t\t\tvalues.push(promiseResult.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tresolve(values);\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t_findLinkedHasOne: function(type, id, link){\n\t\t\tvar _this = this;\n\t\t\tvar linkDef = this._schemaUtils.lookupLinkDef(type, link);\n\t\t\tvar model = linkDef.model;\n\n\t\t\treturn this.findLink(type, id, link).then(function(id){\n\t\t\t\treturn _this._firebaseClient.valueAt([model, id]).then(function(serializedRecord){\n\t\t\t\t\treturn _this._serializer.deserialize(model, id, serializedRecord);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n\n});","define('orbit-firebase/firebase-serializer', ['exports', 'orbit-common/serializer', 'orbit/lib/objects', 'orbit/lib/assert', 'orbit-firebase/transformations', 'orbit/main', 'orbit-common/main'], function (exports, Serializer, objects, assert, transformations, Orbit, OC) {\n\n\t'use strict';\n\n\texports['default'] = Serializer['default'].extend({\n\t\tserialize: function(type, record){\n\t\t\treturn this.serializeRecord(type, record);\n\t\t},\n\n\t\tserializeRecord: function(type, record) {\n\t\t\tassert.assert(record, \"Must provide a record\");\n\n\t\t\tvar json = {};\n\n\t\t\tthis.serializeKeys(type, record, json);\n\t\t\tthis.serializeAttributes(type, record, json);\n\t\t\tthis.serializeLinks(type, record, json);\n\n\t\t\treturn json;\n\t\t},\n\n\t\tserializeKeys: function(type, record, json) {\n\t\t\tvar modelSchema = this.schema.models[type];\n\t\t\tvar resourceKey = this.resourceKey(type);\n\t\t\tvar value = record[resourceKey];\n\n\t\t\tif (value) {\n\t\t\t\tjson[resourceKey] = value;\n\t\t\t}\n\t\t},\n\n\t\tserializeAttributes: function(type, record, json) {\n\t\t\tvar modelSchema = this.schema.models[type];\n\n\t\t\tObject.keys(modelSchema.attributes).forEach(function(attr) {\n\t\t\t\tthis.serializeAttribute(type, record, attr, json);\n\t\t\t}, this);\n\t\t},\n\n\t\tserializeAttribute: function(type, record, attr, json) {\n\t\t\tvar attrType = this.schema.models[type].attributes[attr].type;\n\t\t\tvar transformation = transformations.lookupTransformation(attrType);\n\t\t\tvar value = record[attr];\n\t\t\tvar serialized = transformation.serialize(value);\n\n\t\t\tjson[this.resourceAttr(type, attr)] = serialized;\n\t\t},\n\n\t\tserializeLinks: function(type, record, json) {\n\t\t\tvar modelSchema = this.schema.models[type];\n\t\t\tvar linkNames = Object.keys(modelSchema.links);\n\n\t\t\tlinkNames.forEach(function(link){\n\t\t\t\tvar value = record.__rel[link];\n\n\t\t\t\tif(value === OC['default'].LINK_NOT_INITIALIZED) throw new Error(\"Can't save \" + type + \"/\" + record.id + \" with \" + link + \" not loaded\");\n\n\t\t\t\tjson[link] = value;\n\t\t\t});\n\t\t},\n\n\t\tdeserializeRecords: function(type, records){\n\t\t\tvar _this = this;\n\t\t\treturn records.map(function(record){\n\t\t\t\treturn _this.deserialize(type, record.id, record);\n\t\t\t});\n\t\t},\n\n\t\tdeserialize: function(type, id, record){\n\t\t\trecord = record || {};\n\t\t\tvar data = {};\n\n\t\t\tthis.deserializeKeys(type, id, record, data);\n\t\t\tthis.deserializeAttributes(type, record, data);\n\t\t\tthis.deserializeLinks(type, record, data);\n\n\t\t\treturn this.schema.normalize(type, data, {initializeLinks: false});\n\t\t},\n\n\t\tdeserializeKeys: function(type, id, record, data){\n\t\t\tdata[this.schema.models[type].primaryKey.name] = id;\n\t\t},\n\n\t\tdeserializeAttributes: function(type, record, data){\n\t\t\tvar modelSchema = this.schema.models[type];\n\n\t\t\tObject.keys(modelSchema.attributes).forEach(function(attr) {\n\t\t\t\tthis.deserializeAttribute(type, record, attr, data);\n\t\t\t}, this);\n\t\t},\n\n\t\tdeserializeAttribute: function(type, record, attr, data){\n\t\t\tvar attrType = this.schema.models[type].attributes[attr].type;\n\t\t\tvar transformation = transformations.lookupTransformation(attrType);\n\t\t\tvar serialized = record[attr];\n\t\t\tvar deserialized = transformation.deserialize(serialized);\n\n\t\t\tdata[attr] = deserialized || null; // firebase doesn't like 'undefined' so replace with null\n\t\t},\n\n\t\tdeserializeLinks: function(type, record, data){\n\t\t\tvar _this = this;\n\t\t\tvar modelSchema = this.schema.models[type];\n\t\t\tdata.__rel = {};\n\n\t\t\t// links are only added by link subscriptions - this allows the permissions to be checked before adding them to the record\n\t\t\tObject.keys(modelSchema.links).forEach(function(link) {\n\t\t\t\tdata.__rel[link] = OC['default'].LINK_NOT_INITIALIZED;\n\t\t\t});\n\t\t},\n\n\t\tbuildHash: function(keys, value){\n\t\t\tvar hash = {};\n\n\t\t\tkeys.forEach(function(key){\n\t\t\t\thash[key] = value;\n\t\t\t});\n\n\t\t\treturn hash;\n\t\t},\n\n\t\tresourceKey: function(type) {\n\t\t\treturn 'id';\n\t\t},\n\n\t\tresourceType: function(type) {\n\t\t\treturn this.schema.pluralize(type);\n\t\t},\n\n\t\tresourceLink: function(type, link) {\n\t\t\treturn link;\n\t\t},\n\n\t\tresourceAttr: function(type, attr) {\n\t\t\treturn attr;\n\t\t}\n\t});\n\n});","define('orbit-firebase/firebase-source', ['exports', 'orbit/lib/objects', 'orbit/main', 'orbit-common/main', 'orbit/lib/assert', 'orbit-common/source', 'orbit-firebase/lib/array-utils', 'orbit/operation', 'orbit-firebase/firebase-client', 'orbit-firebase/firebase-requester', 'orbit-firebase/firebase-transformer', 'orbit-firebase/firebase-serializer', 'orbit-firebase/firebase-listener', 'orbit-firebase/cache-source', 'orbit-firebase/operation-matcher', 'orbit-firebase/operation-decomposer', 'orbit-firebase/operation-sequencer', 'orbit-common/operation-encoder', 'orbit-firebase/operation-filter', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/cache-utils', 'orbit-firebase/lib/operation-utils'], function (exports, objects, Orbit, OC, assert, Source, array_utils, Operation, FirebaseClient, FirebaseRequester, FirebaseTransformer, FirebaseSerializer, FirebaseListener, CacheSource, OperationMatcher, OperationDecomposer, OperationSequencer, OperationEncoder, OperationFilter, SchemaUtils, CacheUtils, operation_utils) {\n\n\t'use strict';\n\n\texports['default'] = Source['default'].extend({\n\t\tnotifierName: \"firebase-source\",\n\n\t\tinit: function(schema, options){\n\t\t\tvar _this = this;\n\t\t\toptions = options || {};\n\n\t\t\twindow.firebaseSource = this;\n\n\t\t\tthis._super.apply(this, arguments);\n\t\t\tthis._cache.maintainInverseLinks = false;\n\n\t\t\tassert.assert('FirebaseSource requires Orbit.Promise be defined', Orbit['default'].Promise);\n\t\t\tassert.assert('FirebaseSource requires Orbit.all be defined', Orbit['default'].all);\n\t\t\tassert.assert('FirebaseSource requires Orbit.allSettled be defined', Orbit['default'].allSettled);\n\t\t\tassert.assert('FirebaseSource requires Orbit.map be defined', Orbit['default'].map);\n\t\t\tassert.assert('FirebaseSource requires Orbit.resolve be defined', Orbit['default'].resolve);\n\t\t\tassert.assert('FirebaseSource requires firebaseRef be defined', options.firebaseRef);\n\n\t\t\tvar firebaseRef = options.firebaseRef;\n\t\t\tvar serializer = new FirebaseSerializer['default'](schema);\n\t\t\tvar firebaseClient = new FirebaseClient['default'](firebaseRef);\n\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](this.schema);\n\t\t\tthis._cacheUtils = new CacheUtils['default'](this._cache);\n\t\t\tthis._firebaseTransformer = new FirebaseTransformer['default'](firebaseClient, schema, serializer);\n\t\t\tthis._firebaseRequester = new FirebaseRequester['default'](firebaseClient, schema, serializer);\n\t\t\tthis._firebaseListener = new FirebaseListener['default'](firebaseRef, schema, serializer);\n\t\t\t_this._operationFilter = new OperationFilter['default']();\n\n\t\t\tvar cacheSource = new CacheSource['default'](this._cache);\n\t\t\tthis._operationSequencer = new OperationSequencer['default'](this._cache, schema);\n\n\t\t\tthis._firebaseListener.on('didTransform', function(operation){\n\t\t\t\t_this._operationSequencer.process(operation);\n\t\t\t});\n\n\t\t\tthis._operationSequencer.on('didTransform', function(operation){\n\t\t\t\t// console.log(\"sequenced\", [operation.id, operation.op, operation.path.join(\"/\"), JSON.stringify(operation.value)].join(\"::\"));\n\t\t\t\tif(!_this._operationFilter.blocksNext(operation) && !_this._cacheUtils.isRedundent(operation)){\n\t\t\t\t\tvar inverse = _this._cache.transform(operation);\n\n\t\t\t\t\t// console.log(\"fb.transmitting \", [operation.id, operation.op, operation.path.join(\"/\"), JSON.stringify(operation.value)].join(\"::\"));\n\t\t\t\t\t_this.didTransform(operation, inverse);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._operationEncoder = new OperationEncoder['default'](schema);\n\t\t},\n\n\t\tdisconnect: function(){\n\t\t\treturn this._firebaseListener.unsubscribeAll();\n\t\t},\n\n\t\t_transform: function(operation){\n\t\t\t// console.log(\"fb.transform\", operation.serialize());\n\t\t\tvar _this = this;\n\n\t\t\tif(this._isIgnoredOperation(operation)) return Orbit['default'].resolve();\n\n\t\t\tthis._operationFilter.blockNext(operation);\n\t\t\treturn this._firebaseTransformer.transform(operation).then(function(result){\n\n\t\t\t\tif(operation.op === \"add\" && operation.path.length === 2){\n\t\t\t\t\tvar type = operation.path[0];\n\t\t\t\t\tvar allLinks = _this._schemaUtils.linksFor(type);\n\t\t\t\t\t_this._subscribeToRecords(type, result, {include: allLinks});\n\t\t\t\t\treturn _this._firebaseListener;\n\t\t\t\t}\n\n\t\t\t\telse if(operation.op !== \"remove\" && operation.path.length === 2){\n\t\t\t\t\toperation.value = _this.schema.normalize(operation.path[0], operation.value);\n\t\t\t\t}\n\n\t\t\t});\n\t\t},\n\n\t\t_isIgnoredOperation: function(operation){\n\t\t\tvar operationType = this._operationEncoder.identify(operation);\n\n\t\t\tswitch(operationType){\n\t\t\t\tcase 'addHasOne':\n\t\t\t\tcase 'replaceHasOne':\n\t\t\t\tcase 'addHasMany':\n\t\t\t\tcase 'replaceHasMany':\n\t\t\t\t\treturn operation.value === OC['default'].LINK_NOT_INITIALIZED;\n\n\t\t\t\tdefault: return false;\n\t\t\t}\n\t\t},\n\n\t\t_find: function(type, id, options){\n\t\t\tvar _this = this;\n\t\t\treturn this._firebaseRequester.find(type, id).then(function(records){\n\t\t\t\tif(!id) _this._firebaseListener.subscribeToType(type, null, options);\n\t\t\t\t_this._subscribeToRecords(type, records, options);\n\n\t      return _this._firebaseListener.then(function(){\n\t        return _this.settleTransforms();\n\t      })\n\t      .then(function(){\n\t        return records;\n\n\t      });\n\t\t\t});\n\t\t},\n\n\t\t_findLink: function(type, id, link){\n\t\t\t// todo - why are no subscriptions created? maybe irrelevant\n\t\t\treturn this._firebaseRequester.findLink(type, id, link);\n\t\t},\n\n\t\t_findLinked: function(type, id, link, options){\n\t\t\t// console.log(\"fb._findLinked\", arguments);\n\t\t\tvar _this = this;\n\t\t\tvar linkedType = this.schema.models[type].links[link].model;\n\n\t\t\treturn this._firebaseRequester.findLinked(type, id, link).then(function(records){\n\t\t\t\t_this._firebaseListener.subscribeToLink(type, id, link, options);\n\t\t\t\treturn _this._firebaseListener.then(function(){\n\t\t\t\t\treturn _this.settleTransforms();\n\t\t\t\t})\n\t\t\t\t.then(function(){\n\t\t\t\t\treturn records;\n\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t\t_subscribeToRecords: function(type, records, options){\n\t\t\trecords = objects.isArray(records) ? records : [records];\n\t\t\treturn this._firebaseListener.subscribeToRecords(type, array_utils.pluck(records, 'id'), options);\n\t\t}\n\t});\n\n});","define('orbit-firebase/firebase-transformer', ['exports', 'orbit/lib/objects', 'orbit-firebase/transformers/add-record', 'orbit-firebase/transformers/remove-record', 'orbit-firebase/transformers/replace-attribute', 'orbit-firebase/transformers/add-to-has-many', 'orbit-firebase/transformers/add-to-has-one', 'orbit-firebase/transformers/remove-has-one', 'orbit-firebase/transformers/replace-has-many', 'orbit-firebase/transformers/remove-from-has-many', 'orbit-firebase/transformers/update-meta'], function (exports, objects, AddRecord, RemoveRecord, ReplaceAttribute, AddToHasMany, AddToHasOne, RemoveHasOne, ReplaceHasMany, RemoveFromHasMany, UpdateMeta) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema, serializer, cache){\n\t\t\tthis._schema = schema;\n\t\t\tthis._firebaseClient = firebaseClient;\n\n\t\t\tthis._transformers = [\n\t\t\t\tnew AddRecord['default'](firebaseClient, schema, serializer),\n\t\t\t\tnew RemoveRecord['default'](firebaseClient),\n\t\t\t\tnew ReplaceAttribute['default'](firebaseClient, schema),\n\t\t\t\tnew AddToHasMany['default'](firebaseClient, schema),\n\t\t\t\tnew AddToHasOne['default'](firebaseClient, schema),\n\t\t\t\tnew RemoveHasOne['default'](firebaseClient, schema),\n\t\t\t\tnew ReplaceHasMany['default'](firebaseClient, schema),\n\t\t\t\tnew RemoveFromHasMany['default'](firebaseClient, schema),\n\t\t\t\tnew UpdateMeta['default'](cache)\n\t\t\t];\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar _this = this;\n\t\t\tthis._normalizeOperation(operation);\n\n\t\t\tvar transformer = this._findTransformer(operation);\n\t\t\treturn transformer.transform(operation).then(function(result){\n\t\t\t\treturn _this._firebaseClient.push('operation', operation.serialize()).then(function(){\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\n\t    _normalizeOperation: function(op) {\n\t      if (typeof op.path === 'string') {\n\t      \top.path = op.path.split('/');\n\t      }\n\t    },\n\n\t\t_findTransformer: function(operation){\n\t\t\tfor(var i = 0; i < this._transformers.length; i++){\n\t\t\t\tvar transformer = this._transformers[i];\n\n\t\t\t\tif(transformer.handles(operation)) {\n\t\t\t\t\t// console.log(\"using transformer\", transformer);\n\t\t\t\t\treturn transformer;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthrow new Error(\"Couldn't find a transformer for: \" + JSON.stringify(operation));\n\t\t}\n\t});\n\n});","define('orbit-firebase/lib/array-utils', ['exports'], function (exports) {\n\n\t'use strict';\n\n\texports.removeItem = removeItem;\n\texports.removeAt = removeAt;\n\texports.map = map;\n\texports.pluck = pluck;\n\texports.any = any;\n\texports.arrayToHash = arrayToHash;\n\n\tfunction removeItem(array, condemned){\n\t\treturn array.filter(function(item){\n\t\t\treturn item !== condemned;\n\t\t});\n\t}\n\n\tfunction removeAt(array, index){\n\t\tvar working = array.splice(0);\n\t\tworking.splice(index, 1);\n\t\treturn working;\n\t}\n\n\tfunction map(array, callback){\n\t\tvar mapped = [];\n\n\t\tfor(var i = 0; i < array.length; i++){\n\t\t\tmapped[i] = callback(array[i]);\n\t\t}\n\n\t\treturn mapped;\n\t}\n\n\tfunction pluck(array, property){\n\t\treturn map(array, function(item){\n\t\t\treturn item[property];\n\t\t});\n\t}\n\n\tfunction any(array, callback){\n\t  var item;\n\n\t  for(var i = 0; i < array.length; i++){\n\t    item = array[i];\n\t    if (callback(item) ) return true;\n\t  }\n\n\t\treturn false;\n\t}\n\n\tfunction arrayToHash(array, value){\n\t  var hash = {};\n\n\t  array.forEach(function(item){\n\t    hash[item] = value;\n\t  });\n\n\t  return hash;\n\t}\n\n});","define('orbit-firebase/lib/cache-utils', ['exports', 'orbit/lib/objects', 'orbit-common/operation-encoder', 'orbit/lib/eq'], function (exports, objects, OperationEncoder, eq) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(cache){\n\t\t\tthis.cache = cache;\n\t\t\tthis._operationEncoder = new OperationEncoder['default'](cache.schema);\n\t\t},\n\n\t\tretrieveLink: function(type, id, link) {\n\t\t\tvar val = this.cache.retrieve([type, id, '__rel', link]);\n\t\t\tif (val !== null && typeof val === 'object') {\n\t\t\t\tval = Object.keys(val);\n\t\t\t}\n\t\t\treturn val;\n\t\t},\n\n\t\tisRedundent: function(operation){\n\t\t\tvar operationType = this._operationEncoder.identify(operation);\n\t\t\t\n\t\t\tif(operationType === 'addRecord'){\n\t\t\t\treturn !!this.cache.retrieve(operation.path);\n\t\t\t}\n\n\t\t\tif(operation.op === 'add' || operation.op === 'replace'){\n\t\t\t\treturn eq.eq(this.cache.retrieve(operation.path), operation.value);\n\t\t\t}\n\n\t\t\tif(operation.op === 'remove'){\n\t\t\t\treturn !this.cache.retrieve(operation.path);\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t});\n\n});","define('orbit-firebase/lib/object-utils', ['exports'], function (exports) {\n\n  'use strict';\n\n  exports.objectValues = objectValues;\n  exports.deepMerge = deepMerge;\n  exports.asHash = asHash;\n\n  function objectValues(object){\n  \tif(!object) return [];\n  \treturn Object.keys(object).map(function(key){\n  \t\treturn object[key];\n  \t});\n  }\n\n  function deepMerge(target, src) {\n    var array = Array.isArray(src);\n    var dst = array && [] || {};\n\n    if (array) {\n      target = target || [];\n      dst = dst.concat(target);\n      src.forEach(function(e, i) {\n        if (typeof dst[i] === 'undefined') {\n          dst[i] = e;\n        } else if (typeof e === 'object') {\n          dst[i] = deepMerge(target[i], e);\n        } else {\n          if (target.indexOf(e) === -1) {\n            dst.push(e);\n          }\n        }\n      });\n    } else {\n      if (target && typeof target === 'object') {\n        Object.keys(target).forEach(function(key) {\n          dst[key] = target[key];\n        });\n      }\n      Object.keys(src).forEach(function(key) {\n        if (typeof src[key] !== 'object' || !src[key]) {\n          dst[key] = src[key];\n        } else {\n          if (!target[key]) {\n            dst[key] = src[key];\n          } else {\n            dst[key] = deepMerge(target[key], src[key]);\n          }\n        }\n      });\n    }\n\n    return dst;\n  }\n\n  function asHash(k,v){\n    var hash = {};\n    hash[k] = v;\n    return hash;\n  }\n\n});","define('orbit-firebase/lib/operation-utils', ['exports', 'orbit/lib/objects', 'orbit-firebase/lib/array-utils'], function (exports, objects, array_utils) {\n\n\t'use strict';\n\n\texports.fop = fop;\n\texports.operationToString = operationToString;\n\n\tfunction formatOperation(operation){\n\t\tvar formatted = {\n\t\t\tid: operation.id,\n\t\t\top: operation.op,\n\t\t\tpath: (typeof operation.path === 'string') ? operation.path : operation.path.join(\"/\")\n\t\t};\n\n\t\tif(operation.value) formatted.value = operation.value;\n\n\t\treturn formatted;\n\t}\n\n\tfunction fop(operationOrOperations){\n\t\tif(objects.isArray(operationOrOperations)){\n\t\t\treturn array_utils.reduce(operationOrOperations, function(operation){\n\t\t\t\treturn formatOperation(operation);\n\t\t\t});\n\t\t}\n\t\telse {\n\t\t\treturn formatOperation(operationOrOperations);\n\t\t}\n\t}\n\n\tfunction operationToString(operation){\n\t\treturn [operation.op, operation.path.join(\"/\"), operation.value].join(\":\");\n\t}\n\n});","define('orbit-firebase/lib/promise-utils', ['exports'], function (exports) {\n\n  'use strict';\n\n  exports.timeoutPromise = timeoutPromise;\n\n  /* global clearTimeout */\n\n  function timeoutPromise(promise, label, ms){\n    if(!promise || !promise.then) console.error(\"Not a promise\", label);\n\n    ms = ms || 2000;\n    var timeout = setTimeout(function(){\n      console.log(label);\n    }, ms);\n\n    return promise.then(function(result){\n      clearTimeout(timeout);\n      return result;\n    });\n  }\n\n});","define('orbit-firebase/lib/schema-utils', ['exports', 'orbit/lib/objects'], function (exports, objects) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(schema){\n\t\t\tthis.schema = schema;\n\t\t},\n\n\t\tlookupLinkDef: function(model, link){\n\t\t\tvar modelSchema = this.schema.models[model];\n\t\t\tif(!modelSchema) throw new Error(\"Could not find model for \" + model);\n\t\t\tvar linkDef = modelSchema.links[link];\n\t\t\tif(!linkDef) throw new Error(\"Could not find type for \" + model + \"/\" + link);\n\t\t\treturn linkDef;\n\t\t},\n\n\t\tlookupRelatedLinkDef: function(model, link){\n\t\t\tvar linkDef = this.lookupLinkDef(model, link);\n\t\t\treturn this.schema.models[linkDef.model].links[linkDef.inverse];\n\t\t},\n\n\t\tlinkTypeFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).type;\n\t\t},\n\n\t\tmodelTypeFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).model;\n\t\t},\n\n\t\tmodelSchema: function(type){\n\t\t\tvar modelSchema = this.schema.models[type];\n\t\t\tif(!modelSchema) throw new Error(\"No model found for \" + type);\n\t\t\treturn modelSchema;\n\t\t},\n\n\t\tlinksFor: function(model){\n\t\t\treturn Object.keys(this.modelSchema(model).links);\n\t\t},\n\n\t\tinverseLinkFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).inverse;\n\t\t}\n\t});\n\n});","define('orbit-firebase/mixins/invocations-tracker', ['exports', 'orbit/main', 'orbit/lib/assert', 'orbit/lib/objects', 'orbit/evented'], function (exports, Orbit, assert, objects, Evented) {\n\n  'use strict';\n\n  var InvocationsTracker = {\n\n    extend: function(object) {\n      Evented['default'].extend(object);\n\n      if (object._invocationsTracker === undefined) {\n        objects.extend(object, this.interface);\n        object._invocations = [];\n      }\n      return object;\n    },\n\n    interface: {\n      _invocationsTracker: true,\n\n      _trackInvocations: function(callback){\n        var invocations = this._invocations;\n        var _this = this;\n\n        return function(){\n          var args = arguments;\n          var promise = callback.apply(_this, args);\n          invocations.push(promise);\n\n          return promise.finally(function(){\n            var index = invocations.indexOf(promise);\n\n            if (index > -1) {\n              invocations.splice(index, 1);\n            }\n\n            if(invocations.length === 0){\n              _this.emit(\"_clearedInvocations\");\n            }\n          });\n        };\n      },\n\n      then: function(callback){\n        var _this = this;\n\n        return new Orbit['default'].Promise(function(resolve, reject){\n          if(_this._invocations.length === 0) resolve(callback());\n          else _this.one(\"_clearedInvocations\", function(){\n            resolve(callback());\n          });\n        });\n      }\n    }\n  };\n\n  exports['default'] = InvocationsTracker;\n\n});","define('orbit-firebase/operation-decomposer', ['exports', 'orbit/lib/objects', 'orbit-firebase/operation-matcher', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/cache-utils', 'orbit/operation', 'orbit-firebase/lib/object-utils'], function (exports, objects, OperationMatcher, SchemaUtils, CacheUtils, Operation, object_utils) {\n\n\t'use strict';\n\n\tfunction buildObject(keys, value){\n\t\tvar hash = {};\n\t\tkeys.forEach(function(key){\n\t\t\thash[key] = value;\n\t\t});\n\t\treturn hash;\n\t}\n\n\tvar ChangeDetails = objects.Class.extend({\n\t\tinit: function(path, value, schema, cache){\n\t\t\tthis.path = path;\n\t\t\tthis.value = value;\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils['default'](schema);\n\t\t\tthis.cache = cache;\n\t\t},\n\n\t\tmodel: function(){\n\t\t\treturn this.path[0];\n\t\t},\n\n\t\tmodelId: function(){\n\t\t\treturn this.path[1];\n\t\t},\n\n\t\tlink: function(){\n\t\t\treturn this.path[3];\n\t\t},\n\n\t\tcurrentValue: function(){\n\t\t\treturn this.cache.retrieve(this.path);\n\t\t},\n\n\t\tlinkDef: function(){\n\t\t\treturn this.schemaUtils.lookupLinkDef(this.model(), this.link());\n\t\t},\n\n\t\toriginalInversePath: function(){\n\t\t\treturn [this.linkDef().model, this.currentValue(), \"__rel\", this.linkDef().inverse];\n\t\t},\n\n\t\tinverseLinkDef: function(){\n\t\t\treturn this.schemaUtils.lookupRelatedLinkDef(this.model(), this.link());\n\t\t},\n\n\t\tnewInversePath: function(){\n\t\t\treturn [this.linkDef().model, this.value, \"__rel\", this.linkDef().inverse];\n\t\t}\n\t});\n\n\tvar RelationshipResolver = objects.Class.extend({\n\t\tinit: function(schema, cache){\n\t\t\tthis.visited = [];\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils['default'](schema);\n\t\t\tthis.cache = cache;\n\t\t\tthis.cacheUtils = new CacheUtils['default'](cache);\n\t\t\tthis.operations = [];\n\t\t},\n\n\t\tvisit: function(op, path, value){\n\t\t\tif(this.hasVisited(path)) return;\n\t\t\tthis.markVisited(path);\n\n\t\t\tvar linkType = this.schemaUtils.linkTypeFor(path[0], path[3]);\n\n\t\t\tif(!path[1]) throw new Error(\"invalid modelId: \" + op + \"|\" + path + \"|\" + value);\n\n\t\t\tthis[linkType][op].call(this, path, value);\n\t\t},\n\n\t\thasVisited: function(path){\n\t\t\treturn this.visited.indexOf(path.join(\"/\")) !== -1;\n\t\t},\n\n\t\tmarkVisited: function(path){\n\t\t\tthis.visited.push(path.join(\"/\"));\n\t\t},\n\n\t\thasOne: {\n\t\t\tadd: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'add', path: changeDetails.path, value: changeDetails.value }));\n\t\t\t\tif(changeDetails.currentValue()){\n\t\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t\t}\n\t\t\t\tthis.visit(\"add\", changeDetails.newInversePath(), changeDetails.modelId());\n\t\t\t},\n\n\t\t\tremove: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\t\t\t\tif(!value) return;\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'remove', path: changeDetails.path}));\n\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t},\n\n\t\t\treplace: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'replace', path: changeDetails.path, value: changeDetails.value }));\n\t\t\t\tif(changeDetails.currentValue()){\n\t\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t\t}\n\t\t\t\tthis.visit(\"add\", changeDetails.newInversePath(), changeDetails.modelId());\n\t\t\t}\n\t\t},\n\n\t\thasMany: {\n\t\t\tadd: function(path, value){\n\n\t\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\t\t\t\tvar inversePath = [linkDef.model, value, \"__rel\", linkDef.inverse];\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'add', path: path.concat(value), value: true }));\n\t\t\t\tthis.visit(\"add\", inversePath, path[1]);\n\t\t\t},\n\n\t\t\tremove: function(path, value){\n\t\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\t\t\t\tvar inversePath = [linkDef.model, value, \"__rel\", linkDef.inverse];\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'remove', path: path.concat(value) }));\n\t\t\t\tthis.visit(\"remove\", inversePath, path[1]);\n\t\t\t},\n\n\t\t\treplace: function(path, value){\n\t\t\t\tvar _this = this,\n\t\t\t\t\trelatedLinkDef = this.schemaUtils.lookupRelatedLinkDef(path[0], path[3]);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'replace', path: path, value: buildObject(value, true) }));\n\n\t\t\t\tif(relatedLinkDef.type === 'hasMany') return;\n\n\t\t\t\tvar linkValue = this.cache.retrieve(path),\n\t\t\t\t\tcurrentValue = linkValue ? Object.keys(linkValue) : [],\n\t\t\t\t\tmodelId = path[1],\n\t\t\t\t\tlinkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\n\t\t\t\tvar added = value.filter(function(id){\n\t\t\t\t\treturn currentValue.indexOf(id) === -1;\n\t\t\t\t});\n\t\t\t\tvar removed = currentValue.filter(function(id){\n\t\t\t\t\treturn value.indexOf(id) === -1;\n\t\t\t\t});\n\n\t\t\t\tadded.forEach(function(id){\n\t\t\t\t\tvar inversePath = [linkDef.model, id, \"__rel\", linkDef.inverse];\n\t\t\t\t\t_this.visit(\"add\", inversePath, modelId);\n\t\t\t\t});\n\n\t\t\t\tremoved.forEach(function(id){\n\t\t\t\t\tvar inversePath = [linkDef.model, id, \"__rel\", linkDef.inverse];\n\t\t\t\t\t_this.visit(\"remove\", inversePath, modelId);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(schema, cache){\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils['default'](schema);\n\t\t\tthis.cache = cache;\n\t\t\tthis.cacheUtils = new CacheUtils['default'](cache);\n\t\t},\n\n\t\tdecompose: function(operation){\n\t\t\tif(operation.path[2] !== \"__rel\") return [operation];\n\t\t\tvar relationshipResolver = new RelationshipResolver(this.schema, this.cache);\n\t\t\tvar normalized = this.normalize(operation);\n\t\t\trelationshipResolver.visit(normalized.op, normalized.path, normalized.value);\n\t\t\treturn relationshipResolver.operations;\n\t\t},\n\n\t\tnormalize: function(operation){\n\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(operation.path[0], operation.path[3]);\n\t\t\tvar path = operation.path;\n\n\t\t\tif([\"hasMany\", \"hasOne\"].indexOf(linkDef.type) === -1) throw new Error(\"unsupported link type: \" + linkDef.type);\n\n\t\t\tif(linkDef.type === \"hasOne\" && operation.op === \"add\") return operation;\n\t\t\tif(linkDef.type === \"hasOne\" && operation.op === \"remove\"){\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: path,\n\t\t\t\t\tvalue: this.cache.retrieve(path)\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(linkDef.type === \"hasMany\" && (['add', 'remove'].indexOf(operation.op) !== -1)) {\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: path.slice(0,-1),\n\t\t\t\t\tvalue: path[path.length-1]\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(linkDef.type === \"hasMany\" && operation.op === \"replace\"){\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: operation.path,\n\t\t\t\t\tvalue: Object.keys(operation.value)\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn operation;\n\t\t}\n\t});\n\n});","define('orbit-firebase/operation-filter', ['exports', 'orbit/lib/eq', 'orbit/lib/objects'], function (exports, eq, objects) {\n\n  'use strict';\n\n  var OperationFilter = objects.Class.extend({\n    init: function(){\n      this._blockedOperations = {};\n    },\n\n    blockNext: function(operation){\n      var path = operation.path.join('/');\n      if(!this._blockedOperations[path]) this._blockedOperations[path] = [];\n      this._blockedOperations[path].push(operation);\n    },\n\n    blocksNext: function(operation){\n      if(this.isBlocked(operation)){\n        // console.log(\"blocking\", [operation.id, operation.op, operation.path.join(\"/\"), JSON.stringify(operation.value)].join(\"::\"));\n\n        this.unblock(operation);\n        return true;\n      }\n\n      return false;\n    },\n\n    isBlocked: function(operation){\n      var path = operation.path.join('/');\n      return this._blockedOperations[path] && this._operationIndex(this._blockedOperations[path], operation) !== -1;\n    },\n\n    unblock: function(operation){\n      var path = operation.path.join('/');\n      var index = this._operationIndex(this._blockedOperations[path], operation);\n      this._blockedOperations[path].splice(index, 1);\n    },\n\n    _operationIndex: function(collection, operation){\n      var candidate;\n      var i;\n\n      for(i = 0; i < collection.length; i++){\n        candidate = collection[i];\n        if(eq.eq(candidate.value, operation.value) && eq.eq(candidate.op, operation.op)){\n          return i;\n        }\n        if(candidate.op === 'add' && candidate.path.length === 2 && operation.op === candidate.op){\n          return i;\n        }\n      }\n\n      return -1;\n    }\n  });\n\n  exports['default'] = OperationFilter;\n\n});","define('orbit-firebase/operation-matcher', ['exports', 'orbit/lib/objects', 'orbit/lib/assert'], function (exports, objects, assert) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(operation, schema){\n\t\t\tassert.assert('OperationMatcher requires the operation', operation);\n\t\t\tassert.assert('OperationMatcher requires the schema', schema && schema.models);\n\n\t\t\tthis.valueType = this._determineValueType(operation.path, schema);\n\t\t\tthis.op = operation.op;\n\t\t\tthis.schema = schema;\n\t\t},\n\n\t\tmatches: function(op, valueType){\n\t\t\treturn this.op === op && this.valueType === valueType;\n\t\t},\n\n\t\t_determineValueType: function(path, schema){\n\t\t\tif(path.length === 1) return 'type';\n\t\t\tif(path.length === 2) return 'record';\n\t\t\tif(path.length === 5) return 'link';\n\t\t\tif(path.length === 4 && path[2] === \"__rel\") return 'link';\n\t\t\tif(path[2].match(/^__/)) return \"meta\";\n\n\t\t\tvar model = schema.models[path[0]];\n\t\t\tvar key = path[2];\n\t\t\tif(model.attributes[key]) return 'attribute';\n\t\t\tif(model.keys[key]) return 'key';\n\t\t\tthrow \"Unable to determine value type at: \" + path.join(\"/\");\n\t\t},\t\n\t});\n\n});","define('orbit-firebase/operation-sequencer', ['exports', 'orbit/evented', 'orbit/lib/objects', 'orbit/main', 'orbit-firebase/lib/schema-utils'], function (exports, Evented, objects, Orbit, SchemaUtils) {\n\n  'use strict';\n\n  exports['default'] = objects.Class.extend({\n    init: function(cache, schema){\n      window.operationSequencer = this;\n      Evented['default'].extend(this);\n      this._cache = cache;\n      this._schema = schema;\n      this._schemaUtils = new SchemaUtils['default'](schema);\n      this._dependents = {};\n      this._dependencies = {};\n    },\n\n    process: function(operation){\n      // console.log(\"processing\", [operation.id, operation.op, operation.path.join(\"/\"), JSON.stringify(operation.value)].join(\"::\"));\n      if(this._isRedundent(operation)) return;\n\n      var requiredPaths = this._requiredPathsFor(operation);\n      var missingPaths = this._withoutExistingPaths(requiredPaths);\n\n      if(missingPaths.length > 0){\n        this._deferOperation(operation, missingPaths);\n      }\n      else {\n        this._emit(operation);\n      }\n    },\n\n    _emit: function(operation){\n      this.emit('didTransform', operation);\n      this._triggerOperationsDependentOn(operation);\n    },\n\n    _isRedundent: function(operation){\n      var recordPath = [operation.path[0], operation.path[1]].join(\"/\");\n      var record = this._cache.retrieve(recordPath);\n\n      if(record && operation.path.length === 2 && operation.op !== 'remove') return true;\n      if(!record && operation.path.length === 3) return true;\n      return false;\n    },\n\n    _requiredPathsFor: function(operation){\n      if (this._isRecordOp(operation)) return [];\n\n      var recordPath = this._getRecordPath(operation);\n      if (this._isModifyAttributeOp(operation)) return [recordPath];\n      if (this._isModifyHasOneOp(operation)) return [recordPath];\n      if (this._isInitializeHasManyOp(operation)) return [recordPath];\n\n      var relatedRecordPath = this._getRelatedRecordPath(operation);\n      if (this._isModifyHasManyOp(operation)) return [recordPath, relatedRecordPath];\n\n      return [];\n    },\n\n    _withoutExistingPaths: function(paths){\n      var cache = this._cache;\n\n      return paths.filter(function(path){\n\n        var pathValue = cache.retrieve(path);\n        return !pathValue || pathValue === Orbit['default'].LINK_NOT_INITIALIZED;\n\n      });\n    },\n\n    _deferOperation: function(operation, paths){\n      var _this = this;\n\n      paths.forEach(function(path){\n        _this._addPathDependency(operation, path);\n      });\n    },\n\n    _addPathDependency: function(operation, path){\n      var operationPath = operation.path.join(\"/\");\n      this._dependents[path] = this._dependents[path] || [];\n      this._dependencies[operationPath] = this._dependencies[operationPath] || {};\n      this._dependents[path].push(operation);\n      this._dependencies[operationPath][path] = true;\n    },\n\n    _triggerOperationsDependentOn: function(operation){\n      var _this = this;\n      var path = operation.path.join(\"/\");\n      var dependents = this._dependents[path];\n\n      if(!dependents) {\n        return;\n      }\n\n      for(var i = 0; i < dependents.length; i++){\n        var dependentOperation = dependents[i];\n        var dependentOperationPath = dependentOperation.path.join(\"/\");\n\n        delete _this._dependencies[dependentOperationPath][path];\n\n        if(Object.keys(_this._dependencies[dependentOperationPath]).length === 0) {\n          this._emit(dependentOperation);\n        }\n      }\n\n      delete this._dependents[path];\n    },\n\n    _isRecordOp: function(operation){\n      return operation.path.length === 2;\n    },\n\n    _isInitializeHasManyOp: function(operation){\n      var path = operation.path;\n      return path.length === 4 && this._schema.linkDefinition(path[0], path[3]).type === 'hasMany';\n    },\n\n     _isModifyHasOneOp: function(operation){\n      var path = operation.path;\n      return this._schema.linkDefinition(path[0], path[3]).type === 'hasOne' && path.length === 4;\n    },\n\n    _isModifyAttributeOp: function(operation){\n      return operation.path.length === 3;\n    },\n\n    _isModifyHasManyOp: function(operation){\n      var path = operation.path;\n      return this._schema.linkDefinition(path[0], path[3]).type === 'hasMany' && path.length > 4;\n    },\n\n    _getRecordPath: function(operation){\n      return [operation.path[0], operation.path[1]].join(\"/\");\n    },\n\n    _getRelatedRecordPath: function(operation){\n      var recordType = operation.path[0];\n      var linkName = operation.path[3];\n      var linkedType = this._schema.linkDefinition(recordType, linkName).model;\n      var linkedId = operation.path.length === 5 ? operation.path[4] : operation.value;\n      return [linkedType, linkedId].join(\"/\");\n    }\n  });\n\n});","define('orbit-firebase/related-inverse-links', ['exports', 'orbit-common/main', 'orbit/lib/objects', 'orbit-firebase/operation-matcher', 'orbit/operation', 'orbit-common/operation-encoder', 'orbit/lib/operations'], function (exports, OC, objects, OperationMatcher, Operation, OperationEncoder, lib__operations) {\n\n\t'use strict';\n\n\tfunction asHash(k,v){\n\t  var hash = {};\n\t  hash[k] = v;\n\t  return hash;\n\t}\n\n\tfunction buildObject(keys, value){\n\t\tvar hash = {};\n\t\tkeys.forEach(function(key){\n\t\t\thash[key] = value;\n\t\t});\n\t\treturn hash;\n\t}\n\n\tvar SchemaUtils = objects.Class.extend({\n\t\tinit: function(schema){\n\t\t\tthis.schema = schema;\n\t\t},\n\n\t\tlookupLinkDef: function(model, link){\n\t\t\tvar modelSchema = this.schema.models[model];\n\t\t\tif(!modelSchema) throw new Error(\"Could not find model for \" + model);\n\t\t\tvar linkDef = modelSchema.links[link];\n\t\t\tif(!linkDef) throw new Error(\"Could not find type for \" + model + \"/\" + link);\n\t\t\treturn linkDef;\n\t\t},\n\n\t\tlookupRelatedLinkDef: function(model, link){\n\t\t\tvar linkDef = this.lookupLinkDef(model, link);\n\t\t\treturn this.schema.models[linkDef.model].links[linkDef.inverse];\n\t\t},\n\n\t\tlinkTypeFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).type;\n\t\t},\n\n\t\tmodelTypeFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).model;\n\t\t},\n\n\t\tmodelSchema: function(type){\n\t\t\tvar modelSchema = this.schema.models[type];\n\t\t\tif(!modelSchema) throw new Error(\"No model found for \" + type);\n\t\t\treturn modelSchema;\n\t\t},\n\n\t\tlinksFor: function(model){\n\t\t\treturn Object.keys(this.modelSchema(model).links);\n\t\t},\n\n\t\tinverseLinkFor: function(model, link){\n\t\t\treturn this.lookupLinkDef(model, link).inverse;\n\t\t}\n\t});\n\n\tvar ChangeDetails = objects.Class.extend({\n\t\tinit: function(path, value, schema, cache){\n\t\t\tthis.path = path;\n\t\t\tthis.value = value;\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils(schema);\n\t\t\tthis.cache = cache;\n\t\t},\n\n\t\tmodel: function(){\n\t\t\treturn this.path[0];\n\t\t},\n\n\t\tmodelId: function(){\n\t\t\treturn this.path[1];\n\t\t},\n\n\t\tlink: function(){\n\t\t\treturn this.path[3];\n\t\t},\n\n\t\tcurrentValue: function(){\n\t\t\treturn this.cache.retrieve(this.path);\n\t\t},\n\n\t\tlinkDef: function(){\n\t\t\treturn this.schemaUtils.lookupLinkDef(this.model(), this.link());\n\t\t},\n\n\t\toriginalInversePath: function(){\n\t\t\treturn [this.linkDef().model, this.currentValue(), \"__rel\", this.linkDef().inverse];\n\t\t},\n\n\t\tinverseLinkDef: function(){\n\t\t\treturn this.schemaUtils.lookupRelatedLinkDef(this.model(), this.link());\n\t\t},\n\n\t\tnewInversePath: function(){\n\t\t\treturn [this.linkDef().model, this.value, \"__rel\", this.linkDef().inverse];\n\t\t}\n\t});\n\n\tvar RelationshipResolver = objects.Class.extend({\n\t\tinit: function(schema, cache, initializeLinks){\n\t\t\tthis.visited = [];\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils(schema);\n\t\t\tthis.cache = cache;\n\t\t\tthis.operations = [];\n\t\t\tthis.initializeLinks = initializeLinks;\n\t\t},\n\n\t\tvisit: function(op, path, value){\n\t\t\tif(this.hasVisited(path)) return;\n\t\t\tthis.markVisited(path);\n\t\t\tvar linkType = this.schemaUtils.linkTypeFor(path[0], path[3]);\n\n\t\t\tif(!path[1]) throw new Error(\"invalid modelId: \" + op + \"|\" + path + \"|\" + value);\n\n\t\t\tthis[linkType][op].call(this, path, value);\n\t\t},\n\n\t\thasVisited: function(path){\n\t\t\treturn this.visited.indexOf(path.join(\"/\")) !== -1;\n\t\t},\n\n\t\tmarkVisited: function(path){\n\t\t\tthis.visited.push(path.join(\"/\"));\n\t\t},\n\n\t\tisUninitialized: function(path){\n\t\t\treturn this.cache.retrieve(path) === OC['default'].LINK_NOT_INITIALIZED;\n\t\t},\n\n\t\thasOne: {\n\t\t\tadd: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'add', path: changeDetails.path, value: changeDetails.value }));\n\t\t\t\tif(changeDetails.currentValue()){\n\t\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t\t}\n\t\t\t\tthis.visit(\"add\", changeDetails.newInversePath(), changeDetails.modelId());\n\t\t\t},\n\n\t\t\tremove: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\t\t\t\tif(!value) return;\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'remove', path: changeDetails.path}));\n\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t},\n\n\t\t\treplace: function(path, value){\n\t\t\t\tvar changeDetails = new ChangeDetails(path, value, this.schema, this.cache);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'replace', path: changeDetails.path, value: changeDetails.value }));\n\t\t\t\tif(changeDetails.currentValue()){\n\t\t\t\t\tthis.visit(\"remove\", changeDetails.originalInversePath(), changeDetails.modelId());\n\t\t\t\t}\n\t\t\t\tthis.visit(\"add\", changeDetails.newInversePath(), changeDetails.modelId());\n\t\t\t}\n\t\t},\n\n\t\thasMany: {\n\t\t\tadd: function(path, value){\n\n\t\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\t\t\t\tvar inversePath = [linkDef.model, value, \"__rel\", linkDef.inverse];\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'add', path: path.concat(value), value: true }));\n\t\t\t\tthis.visit(\"add\", inversePath, path[1]);\n\t\t\t},\n\n\t\t\tremove: function(path, value){\n\t\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\t\t\t\tvar inversePath = [linkDef.model, value, \"__rel\", linkDef.inverse];\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'remove', path: path.concat(value) }));\n\t\t\t\tthis.visit(\"remove\", inversePath, path[1]);\n\t\t\t},\n\n\t\t\treplace: function(path, value){\n\t\t\t\tvar _this = this,\n\t\t\t\t\trelatedLinkDef = this.schemaUtils.lookupRelatedLinkDef(path[0], path[3]);\n\n\t\t\t\tthis.operations.push(new Operation['default']({ op: 'replace', path: path, value: buildObject(value, true) }));\n\n\t\t\t\tvar linkValue = this.cache.retrieve(path);\n\t\t\t\tvar currentValue = linkValue ? Object.keys(linkValue) : [];\n\t\t\t\tvar modelId = path[1];\n\t\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(path[0], path[3]);\n\n\t\t\t\tvar added = value.filter(function(id){\n\t\t\t\t\treturn currentValue.indexOf(id) === -1;\n\t\t\t\t});\n\n\t\t\t\tvar removed = currentValue.filter(function(id){\n\t\t\t\t\treturn value.indexOf(id) === -1;\n\t\t\t\t});\n\n\t\t\t\tadded.forEach(function(id){\n\t\t\t\t\tvar inversePath = [linkDef.model, id, \"__rel\", linkDef.inverse];\n\t\t\t\t\t_this.visit(\"add\", inversePath, modelId);\n\t\t\t\t});\n\n\t\t\t\tremoved.forEach(function(id){\n\t\t\t\t\tvar inversePath = [linkDef.model, id, \"__rel\", linkDef.inverse];\n\t\t\t\t\t_this.visit(\"remove\", inversePath, modelId);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(schema, cache){\n\t\t\tthis.schema = schema;\n\t\t\tthis.schemaUtils = new SchemaUtils(schema);\n\t\t\tthis.cache = cache;\n\t\t\tthis._operationEncoder = new OperationEncoder['default'](schema);\n\t\t},\n\n\t\tprocess: function(operation){\n\t\t\tif(operation.path[2] === \"__rel\") return this.relatedLinkOperations(operation, false);\n\t\t\tif(operation.path.length === 2) return this.relatedRecordOperations(operation);\n\t\t\treturn [operation];\n\t\t},\n\n\t\trelatedRecordOperations: function(operation){\n\t\t\tvar _this = this;\n\t\t\tvar model = operation.path[0];\n\t\t\tvar recordId = operation.path[1];\n\t\t\tvar record = this.cache.retrieve([model, recordId]) || operation.value;\n\n\t\t\tif(!record) throw new Error(\"record not found \", [model, recordId].join(\"/\"));\n\n\t\t\tvar ops = [operation];\n\t\t\tvar linkOps;\n\n\t\t\tthis.schemaUtils.linksFor(model).forEach(function(link){\n\t\t\t\tvar linkValue = record.__rel[link];\n\t\t\t\tif(linkValue){\n\t\t\t\t\tvar linkOperation = {op: operation.op, path: [model, recordId, '__rel', link], value: linkValue};\n\t\t\t\t\tlinkOps = _this.relatedLinkOperations(linkOperation, true);\n\t\t\t\t\tlinkOps.forEach(function(linkOp){\n\t\t\t\t\t\tops.push(linkOp);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tvar coalesced = lib__operations.coalesceOperations(ops);\n\t\t\tvar sorted = this.sortedByPathLength(coalesced);\n\n\t\t\treturn sorted;\n\t\t},\n\n\t\trelatedLinkOperations: function(operation, initializeLinks){\n\t\t\tvar relationshipResolver = new RelationshipResolver(this.schema, this.cache, initializeLinks);\n\t\t\tvar normalized = this.normalize(operation);\n\t\t\trelationshipResolver.visit(normalized.op, normalized.path, normalized.value);\n\t\t\tvar linkOps = relationshipResolver.operations;\n\t\t\tvar sorted = this.sortedByOp(linkOps);\n\n\t\t\treturn sorted;\n\t\t},\n\n\t\tsortedByPathLength: function(operations){\n\t\t\treturn operations.sort(function(a, b){\n\t\t\t\treturn a.path.length > b.path.length;\n\t\t\t});\n\t\t},\n\n\t\tsortedByOp: function(operations){\n\t\t\tvar operationSortKey = this.operationSortKey;\n\n\t\t\treturn operations.sort(function(a, b){\n\t\t\t\treturn operationSortKey(a) > operationSortKey(b);\n\t\t\t});\n\t\t},\n\n\t\toperationSortKey: function(operation){\n\t\t\tvar opOrder = ['remove', 'add', 'replace'];\n\t\t\treturn opOrder.indexOf(operation.op);\n\t\t},\n\n\t\tnormalize: function(operation){\n\t\t\tvar linkDef = this.schemaUtils.lookupLinkDef(operation.path[0], operation.path[3]);\n\t\t\tvar path = operation.path;\n\t\t\tvar operationType = this._operationEncoder.identify(operation);\n\n\t\t\tif(operationType === 'addHasMany'){\n\t\t\t\treturn {\n\t\t\t\t\top: 'replace',\n\t\t\t\t\tpath: operation.path,\n\t\t\t\t\tvalue: Object.keys(operation.value)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif(operationType === 'removeHasMany'){\n\t\t\t\treturn {\n\t\t\t\t\top: 'replace',\n\t\t\t\t\tpath: operation.path,\n\t\t\t\t\tvalue: []\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif([\"hasMany\", \"hasOne\"].indexOf(linkDef.type) === -1) throw new Error(\"unsupported link type: \" + linkDef.type);\n\n\t\t\tif(linkDef.type === \"hasOne\" && operation.op === \"add\") return operation;\n\t\t\tif(linkDef.type === \"hasOne\" && operation.op === \"remove\"){\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: path,\n\t\t\t\t\tvalue: this.cache.retrieve(path)\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(linkDef.type === \"hasMany\" && (['add', 'remove'].indexOf(operation.op) !== -1)) {\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: path.slice(0,-1),\n\t\t\t\t\tvalue: path[path.length-1]\n\t\t\t\t};\n\t\t\t}\n\t\t\tif(linkDef.type === \"hasMany\" && operation.op === \"replace\"){\n\t\t\t\treturn {\n\t\t\t\t\top: operation.op,\n\t\t\t\t\tpath: operation.path,\n\t\t\t\t\tvalue: Object.keys(operation.value)\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn operation;\n\t\t}\n\t});\n\n});","define('orbit-firebase/subscriptions/attribute-subscription', ['exports', 'orbit-firebase/subscriptions/subscription', 'orbit/operation', 'orbit/main', 'orbit-firebase/transformations'], function (exports, Subscription, Operation, Orbit, transformations) {\n\n\t'use strict';\n\n\texports['default'] = Subscription['default'].extend({\n\t\tinit: function(path, listener){\n\t\t\tthis.path = path;\n\t\t\tthis.listener = listener;\n\t\t\tthis.schema = listener._schema;\n\t\t},\n\n\t\tactivate: function(){\n\t\t\tvar _this = this,\n\t\t\t\tlistener = this.listener,\n\t\t\t\tpath = this.path,\n\t\t\t\tsplitPath = this.path.split(\"/\"),\n\t\t\t\ttype = splitPath[0],\n\t\t\t\trecordId = splitPath[1],\n\t\t\t\tattribute = splitPath[2];\n\n\t\t\treturn listener._enableListener(path, \"value\", function(snapshot){\n\t\t\t\tvar splitPath = path.split('/');\n\t\t\t\tvar model = splitPath[0];\n\t\t\t\tvar attribute = splitPath[2];\n\t\t\t\tvar attrType = _this.schema.models[model].attributes[attribute].type;\n\t\t\t\tvar transformation = transformations.lookupTransformation(attrType);\n\t\t\t\tvar serialized = snapshot.val();\n\t\t\t\tvar deserialized = transformation.deserialize(serialized);\n\n\t\t\t\tlistener._emitDidTransform(new Operation['default']({ op: 'replace', path: path, value: deserialized }));\n\t\t\t\treturn Orbit['default'].resolve();\n\t\t\t});\n\t\t},\n\n\t\tupdate: function(){\n\t\t\treturn Orbit['default'].resolve();\n\t\t}\n\t});\n\n});","define('orbit-firebase/subscriptions/has-many-subscription', ['exports', 'orbit-firebase/subscriptions/subscription', 'orbit/operation', 'orbit-firebase/lib/array-utils', 'orbit/main'], function (exports, Subscription, Operation, array_utils, Orbit) {\n\n\t'use strict';\n\n\texports['default'] = Subscription['default'].extend({\n\t\tinit: function(path, listener){\n\t\t\tvar splitPath = path.split('/');\n\n\t\t\tthis.path = path;\n\t\t\tthis._listener = listener;\n\t\t\tthis._type = splitPath[0];\n\t\t\tthis._recordId = splitPath[1];\n\t\t\tthis._link = splitPath[2];\n\t\t\t// this._inverseLink = listener._schemaUtils.inverseLinkFor(this._type, this._link);\n\t\t\tthis._linkType = listener._schemaUtils.modelTypeFor(this._type, this._link);\n\t\t},\n\n\t\tactivate: function(){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this._listener;\n\t\t\tvar path = this.path;\n\t\t\tvar type = this._type;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar link = this._link;\n\t\t\tvar splitPath = path.split(\"/\");\n\t\t\tvar orbitPath = [splitPath[0], splitPath[1], '__rel', splitPath[2]].join(\"/\");\n\n\t\t\treturn this._addRecordListeners().then(function(){\n\t\t\t\tlistener._enableListener(path, \"child_added\", _this._recordAdded.bind(_this));\n\t\t\t\tlistener._enableListener(path, \"child_removed\", _this._recordRemoved.bind(_this));\n\t\t\t});\n\t\t},\n\n\t\tupdate: function(){\n\t\t\treturn this._addRecordListeners();\n\t\t},\n\n\t\t_recordAdded: function(snapshot){\n\t\t\tvar options = this.options;\n\t\t\tvar type = this._type;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar link = this._link;\n\t\t\tvar listener = this._listener;\n\t\t\tvar linkType = this._linkType;\n\t\t\tvar linkId = snapshot.key();\n\n\t\t\tlistener.subscribeToRecord(linkType, linkId, options).then(function(){\n\t\t\t\tlistener._emitDidTransform(new Operation['default']({\n\t\t\t\t\top: 'add',\n\t\t\t\t\tpath: [type, recordId, '__rel', link, linkId].join(\"/\"),\n\t\t\t\t\tvalue: true\n\t\t\t\t}));\n\t\t\t});\n\t\t},\n\n\t\t_recordRemoved: function(snapshot){\n\t\t\tvar type = this._type;\n\t\t\tvar\tlink = this._link;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar listener = this._listener;\n\t\t\tvar\tlinkId = snapshot.key();\n\n\t\t\tlistener._emitDidTransform(new Operation['default']({\n\t\t\t\top: 'remove',\n\t\t\t\tpath: [type, recordId, '__rel', link, linkId].join(\"/\")\n\t\t\t}));\n\t\t},\n\n\t\t_addRecordListeners: function(){\n\t\t\tvar _this = this;\n\t\t\tvar path = this.path;\n\t\t\tvar listener = this._listener;\n\t\t\tvar linkType = this._linkType;\n\t\t\tvar options = this.options; //this._inverseLink ? this.options.addInclude(this._inverseLink) : this.options;\n\n\t\t\treturn listener._firebaseClient.valueAt(path).then(function(linkValue){\n\t\t\t\tvar recordIds = Object.keys(linkValue||{});\n\n\t\t\t\treturn listener.subscribeToRecords(linkType, recordIds, options).then(function(){\n\t\t\t\t\treturn recordIds.filter(function(recordId){\n\t\t\t\t\t\treturn listener.hasActiveSubscription([linkType, recordId].join(\"/\"));\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t});\n\n});","define('orbit-firebase/subscriptions/has-one-subscription', ['exports', 'orbit-firebase/subscriptions/subscription', 'orbit/operation', 'orbit/main'], function (exports, Subscription, Operation, Orbit) {\n\n\t'use strict';\n\n\texports['default'] = Subscription['default'].extend({\n\t\tinit: function(path, listener){\n\t\t\tvar splitPath = path.split(\"/\");\n\n\t\t\tthis.path = path;\n\t\t\tthis._type = splitPath[0];\n\t\t\tthis._recordId = splitPath[1];\n\t\t\tthis._link = splitPath[2];\n\t\t\t// this._inverseLink = listener._schemaUtils.inverseLinkFor(this._type, this._link);\n\t\t\tthis._listener = listener;\n\t\t\tthis._linkType = listener._schemaUtils.modelTypeFor(this._type, this._link);\n\t\t},\n\n\t\tactivate: function(){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this._listener;\n\t\t\tvar type = this._type;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar link = this._link;\n\t\t\tvar options = this.options;\n\t\t\tvar linkType = this._linkType;\n\t\t\tvar enabled = false;\n\n\t\t\treturn listener._enableListener(this.path, \"value\", function(snapshot){\n\t\t\t\tvar wasEnabled = enabled;\n\t\t\t\tenabled = true;\n\t\t\t\tvar linkId = snapshot.val();\n\n\t\t\t\treturn linkId ? _this._replaceLink(linkId) : _this._removeLink(wasEnabled);\n\t\t\t});\n\t\t},\n\n\t\tupdate: function(){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this._listener;\n\t\t\tvar path = this.path;\n\t\t\tvar linkType = this._linkType;\n\n\t\t\treturn listener._firebaseClient.valueAt(path).then(function(linkValue){\n\t\t\t\treturn listener.subscribeToRecord(linkType, linkValue, _this.options);\n\t\t\t});\n\t\t},\n\n\t\t_replaceLink: function(linkId){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this._listener;\n\t\t\tvar linkType = this._linkType;\n\t\t\tvar options = this.options;\n\t\t\tvar type = this._type;\n\t\t\tvar link = this._link;\n\t\t\tvar path = this.path;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar orbitPath = [type, recordId, '__rel', link].join(\"/\");\n\n\t\t\treturn listener.subscribeToRecord(linkType, linkId, options).then(function(subscription){\n\t\t\t\tif(subscription.status === \"permission_denied\") return;\n\t\t\t\t_this._emitOperation(orbitPath, linkId);\n\t\t\t});\n\t\t},\n\n\t\t_removeLink: function(wasEnabled){\n\t\t\tif(!wasEnabled) return;\n\t\t\tvar listener = this._listener;\n\t\t\tvar type = this._type;\n\t\t\tvar recordId = this._recordId;\n\t\t\tvar link = this._link;\n\t\t\tvar orbitPath = [type, recordId, '__rel', link].join(\"/\");\n\n\t\t\tthis._emitOperation(orbitPath, null);\n\t\t},\n\n\t\t_emitOperation: function(path, value){\n\t\t\tvar op = this.linkInitialized ? 'replace' : 'add';\n\t\t\tthis.linkInitialized = true;\n\t\t\tthis._listener._emitDidTransform(new Operation['default']({op: op, path: path, value: value||null}));\n\t\t}\n\t});\n\n});","define('orbit-firebase/subscriptions/options', ['exports', 'orbit/lib/objects'], function (exports, objects) {\n\n  'use strict';\n\n  exports.buildOptions = buildOptions;\n\n  var Options = objects.Class.extend({\n  \tinit: function(optionsHash){\n      this.include = optionsHash.include;\n  \t},\n\n    currentIncludes: function(){\n      return Object.keys(this.include||{});\n    },\n\n    forLink: function(link){\n      var linkOptions = objects.clone(this);\n      linkOptions.include = this.include[link];\n      return new Options(linkOptions);\n    },\n\n    addInclude: function(link){\n      if(!link) throw new Error(\"link not specified\");\n      var options = objects.clone(this);\n      if(!options.include) options.include = {};\n      options.include[link] = {};\n      return new Options(options);\n    }\n  });\n\n  function buildOptions(optionsHash){\n    if(optionsHash instanceof Options) return optionsHash;\n\n    optionsHash = optionsHash || {};\n    var include = parseInclude(optionsHash.include);\n\n    return new Options({include: include});\n  }\n\n  function parseInclude(include){\n    if (!include) return undefined;\n    if (!objects.isArray(include)) {\n      include = [include];\n    }\n\n    var parsed = {};\n\n    include.forEach(function(inclusion){\n      var current = parsed;\n      inclusion.split(\".\").forEach(function(link){\n        current[link] = current[link] || {};\n        current = current[link];\n      });\n    });\n\n    return parsed;\n  }\n\n});","define('orbit-firebase/subscriptions/record-subscription', ['exports', 'orbit-firebase/subscriptions/subscription', 'orbit/operation', 'orbit/main', 'orbit-firebase/transformations'], function (exports, Subscription, Operation, Orbit, transformations) {\n\n\t'use strict';\n\n\texports['default'] = Subscription['default'].extend({\n\t\tinit: function(path, listener){\n\t\t\tthis.path = path;\n\t\t\tthis.listener = listener;\n\t\t\tvar splitPath = this.path.split(\"/\");\n\t\t\tthis.type = splitPath[0];\n\t\t\tthis.recordId = splitPath[1];\n\t\t\tthis.modelSchema = listener._schemaUtils.modelSchema(this.type);\n\t\t},\n\n\t\tactivate: function(){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this.listener;\n\t\t\tvar path = this.path;\n\t\t\tvar type = this.type;\n\t\t\tvar recordId = this.recordId;\n\t\t\tvar modelSchema = this.modelSchema;\n\t\t\tvar options = this.options;\n\n\t\t\treturn listener._loadRecord(type, recordId).then(function(record){\n\t\t\t\t_this.subscribeToAttributes();\n\t\t\t\t_this.subscribeToLinks();\n\t\t\t\t_this.subscribeToRecordRemoved();\n\t\t\t});\n\t\t},\n\n\t\tsubscribeToRecordRemoved: function(){\n\t\t\tvar _this = this;\n\t\t\tvar idPath = this.path + \"/id\";\n\t\t\tvar listener = this.listener;\n\n\t\t\tlistener._enableListener(idPath, \"value\", function(snapshot){\n\t\t\t\tif(!snapshot.val()){\n\t\t\t\t\tlistener._emitDidTransform(new Operation['default']({ op: 'remove', path: _this.path }));\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\tsubscribeToLinks: function(){\n\t\t\tvar _this = this;\n\n\t\t\tthis.options.currentIncludes().map(function(link){\n\t\t\t\treturn _this.listener.subscribeToLink(_this.type, _this.recordId, link, _this.options.forLink(link));\n\t\t\t});\n\t\t},\n\n\t\tsubscribeToAttributes: function(){\n\t\t\tvar _this = this;\n\t\t\tvar listener = this.listener;\n\n\t\t\tlistener._enableListener(this.path, \"child_changed\", function(snapshot){\n\t\t\t\tvar key = snapshot.key();\n\t\t\t\tvar value = snapshot.val();\n\n\t\t\t\tif(_this._isAttribute(key)){\n\t\t\t\t\t_this._updateAttribute(key, value);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t_removeRecord: function(){\n\t\t\tthis.listener._emitDidTransform(new Operation['default']({ op: 'remove', path: this.path }));\n\t\t},\n\n\t\t_updateAttribute: function(attribute, serialized){\n\t\t\tvar model = this.type;\n\t\t\tvar attrType = this.modelSchema.attributes[attribute].type;\n\t\t\tvar transformation = transformations.lookupTransformation(attrType);\n\t\t\tvar deserialized = transformation.deserialize(serialized);\n\t\t\tvar attributePath = this.path + \"/\" + attribute;\n\n\t\t\tthis.listener._emitDidTransform(new Operation['default']({ op: 'replace', path: attributePath, value: deserialized }));\n\t\t},\n\n\t\t_isAttribute: function(key){\n\t\t\treturn Object.keys(this.modelSchema.attributes).indexOf(key) !== -1;\n\t\t},\n\n\t\tupdate: function(){\n\t\t\tvar listener = this.listener;\n\t\t\tvar options = this.options;\n\t\t\tvar splitPath = this.path.split(\"/\");\n\t\t\tvar type = splitPath[0];\n\t\t\tvar recordId = splitPath[1];\n\n\t\t\toptions.currentIncludes().map(function(link){\n\t\t\t\treturn listener.subscribeToLink(type, recordId, link, options.forLink(link));\n\t\t\t});\n\n\t\t\treturn Orbit['default'].resolve();\n\t\t}\n\t});\n\n});","define('orbit-firebase/subscriptions/subscription', ['exports', 'orbit/lib/objects', 'orbit/main'], function (exports, objects, Orbit) {\n\n  'use strict';\n\n  exports['default'] = objects.Class.extend({\n    enqueue: function(func){\n      this._queue = this._queue || Orbit['default'].resolve();\n      this._queue = this._queue.then(func);\n      return this._queue;\n    }\n  });\n\n});","define('orbit-firebase/transformations', ['exports'], function (exports) {\n\n  'use strict';\n\n  exports.lookupTransformation = lookupTransformation;\n\n  var transformations = {\n    date: {\n      serialize: function(value){\n        return value && value.getTime();\n      },\n\n      deserialize: function(serialized){\n        return serialized && new Date(serialized);\n      }\n    },\n\n    defaultTransformation: {\n      serialize: function(value){\n        return value;\n      },\n\n      deserialize: function(serialized){\n        return serialized;\n      }\n    },\n  };\n\n  function lookupTransformation(attrType){\n    return transformations[attrType] || transformations.defaultTransformation;\n  }\n\n});","define('orbit-firebase/transformers/add-record', ['exports', 'orbit/lib/objects'], function (exports, objects) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema, serializer){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schema = schema;\n\t\t\tthis._serializer = serializer;\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\treturn operation.op === \"add\" && operation.path.length === 2;\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar model = operation.path[0];\n\t\t\tvar record = this._schema.normalize(model, operation.value);\n\t\t\tvar serializedRecord = this._serializer.serializeRecord(model, record);\n\n\t\t\treturn this._firebaseClient.set(operation.path, serializedRecord);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/add-to-has-many', ['exports', 'orbit/lib/objects', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/array-utils'], function (exports, objects, SchemaUtils, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\tvar path = operation.path;\n\t\t\tif(path[2] !== '__rel') return; \n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(path[0], path[3]).type;\n\t\t\treturn operation.op === \"add\" && linkType === 'hasMany';\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar path = array_utils.removeItem(operation.path, '__rel');\n\t\t\treturn this._firebaseClient.set(path, operation.value);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/add-to-has-one', ['exports', 'orbit/main', 'orbit-common/main', 'orbit/lib/objects', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/array-utils'], function (exports, Orbit, OC, objects, SchemaUtils, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\tvar path = operation.path;\n\t\t\tif(path[2] !== '__rel') return;\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(path[0], path[3]).type;\n\t\t\treturn [\"add\", \"replace\"].indexOf(operation.op) !== -1 && path[2] === '__rel' && linkType === 'hasOne';\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar path = array_utils.removeItem(operation.path, '__rel');\n\t\t\treturn this._firebaseClient.set(path, operation.value);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/remove-from-has-many', ['exports', 'orbit/lib/objects', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/array-utils'], function (exports, objects, SchemaUtils, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\tvar path = operation.path;\n\t\t\tif(path[2] !== '__rel') return;\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(path[0], path[3]).type;\n\t\t\treturn operation.op === \"remove\" && path[2] === '__rel' && linkType === 'hasMany';\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar path = array_utils.removeItem(operation.path, '__rel');\n\t\t\treturn this._firebaseClient.remove(path);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/remove-has-one', ['exports', 'orbit/lib/objects', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/array-utils'], function (exports, objects, SchemaUtils, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\tvar path = operation.path;\n\t\t\tif(path[2] !== '__rel') return;\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(path[0], path[3]).type;\n\t\t\treturn operation.op === \"remove\" && path[2] === '__rel' && linkType === 'hasOne';\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar path = array_utils.removeItem(operation.path, '__rel');\n\t\t\treturn this._firebaseClient.remove(path);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/remove-record', ['exports', 'orbit/lib/objects'], function (exports, objects) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\treturn operation.op === \"remove\" && operation.path.length === 2;\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\treturn this._firebaseClient.set(operation.path, null);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/replace-attribute', ['exports', 'orbit/lib/objects', 'orbit-firebase/transformations'], function (exports, objects, transformations) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t    this._schema = schema;\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\treturn [\"replace\", \"add\"].indexOf(operation.op) !== -1 && operation.path.length === 3 && !operation.path[2].match(/^__/);\n\t\t},\n\n\t\ttransform: function(operation){\n\t    var model = operation.path[0];\n\t    var attr = operation.path[2];\n\t    var value = operation.value;\n\t    var attrType = this._schema.models[model].attributes[attr].type;\n\t    var transformation = transformations.lookupTransformation(attrType);\n\t    var serialized = transformation.serialize(value);\n\n\t\t\treturn this._firebaseClient.set(operation.path, serialized);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/replace-has-many', ['exports', 'orbit/main', 'orbit-common/main', 'orbit/lib/objects', 'orbit-firebase/lib/schema-utils', 'orbit-firebase/lib/array-utils'], function (exports, Orbit, OC, objects, SchemaUtils, array_utils) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(firebaseClient, schema){\n\t\t\tthis._firebaseClient = firebaseClient;\n\t\t\tthis._schemaUtils = new SchemaUtils['default'](schema);\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\tvar path = operation.path;\n\t\t\tif(path[2] !== '__rel') return;\n\t\t\tvar linkType = this._schemaUtils.lookupLinkDef(path[0], path[3]).type;\n\t\t\treturn operation.op === \"replace\" && path[2] === '__rel' && linkType === 'hasMany';\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tvar path = array_utils.removeItem(operation.path, '__rel');\n\t\t\treturn this._firebaseClient.set(path, operation.value);\n\t\t}\n\t});\n\n});","define('orbit-firebase/transformers/update-meta', ['exports', 'orbit/lib/objects', 'orbit/main'], function (exports, objects, Orbit) {\n\n\t'use strict';\n\n\texports['default'] = objects.Class.extend({\n\t\tinit: function(cache){\n\t\t\tthis._cache = cache;\n\t\t},\n\n\t\thandles: function(operation){\n\t\t\treturn operation.path[2].match(/^__/);\n\t\t},\n\n\t\ttransform: function(operation){\n\t\t\tthis._cache.transform(operation);\n\t\t\treturn Orbit['default'].resolve();\n\t\t}\n\t});\n\n});"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC7QA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AClIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC1IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACxDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC3UA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AChGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACzBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;","file":"orbit-firebase.amd.js"}